Namespace(batch_size=25, caption_path='./coco/annotations/sm_captions_train2014.json', crop_size=224, embed_size=512, hidden_size=512, image_dir='./data/resized2014', learning_rate=0.001, log_step=100, model_path='./models/ATT', num_epochs=40, num_layers=1, num_workers=2, save_step=10, vocab_path='./data/vocab.pkl')
loading annotations into memory...
0:00:00.111650
creating index...
index created!
----- DATA_LOADER -- loaded data ----
---- USING GPU ----
train_att.py:22: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  return Variable(x, volatile=volatile)
train_att.py:100: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  loss.data[0], np.exp(loss.data[0]), time.time()-t0))
Epoch [0/40], Step [0/1001], Loss: 9.1993, Perplexity: 9890.3340, Time: 0.8593
Epoch [0/40], Step [100/1001], Loss: 4.4449, Perplexity: 85.1886, Time: 31.0426
Epoch [0/40], Step [200/1001], Loss: 3.7893, Perplexity: 44.2276, Time: 69.2370
Epoch [0/40], Step [300/1001], Loss: 4.3472, Perplexity: 77.2603, Time: 100.4122
Epoch [0/40], Step [400/1001], Loss: 4.0250, Perplexity: 55.9826, Time: 131.9896
Epoch [0/40], Step [500/1001], Loss: 4.4650, Perplexity: 86.9184, Time: 164.0151
Epoch [0/40], Step [600/1001], Loss: 3.3888, Perplexity: 29.6302, Time: 196.2893
Epoch [0/40], Step [700/1001], Loss: 4.4955, Perplexity: 89.6159, Time: 228.4758
Epoch [0/40], Step [800/1001], Loss: 3.8255, Perplexity: 45.8562, Time: 260.3015
Epoch [0/40], Step [900/1001], Loss: 4.1784, Perplexity: 65.2582, Time: 292.2831
Epoch [0/40], Step [1000/1001], Loss: 4.5325, Perplexity: 92.9897, Time: 323.7014
Epoch [1/40], Step [0/1001], Loss: 4.8433, Perplexity: 126.8928, Time: 324.3345
Epoch [1/40], Step [100/1001], Loss: 4.3727, Perplexity: 79.2567, Time: 356.6580
Epoch [1/40], Step [200/1001], Loss: 3.5075, Perplexity: 33.3647, Time: 388.3998
Epoch [1/40], Step [300/1001], Loss: 3.2888, Perplexity: 26.8116, Time: 420.1177
Epoch [1/40], Step [400/1001], Loss: 4.4585, Perplexity: 86.3551, Time: 452.0563
Epoch [1/40], Step [500/1001], Loss: 4.1973, Perplexity: 66.5069, Time: 483.7982
Epoch [1/40], Step [600/1001], Loss: 4.2272, Perplexity: 68.5266, Time: 515.4491
Epoch [1/40], Step [700/1001], Loss: 4.1499, Perplexity: 63.4280, Time: 547.0177
Epoch [1/40], Step [800/1001], Loss: 4.6651, Perplexity: 106.1734, Time: 578.7379
Epoch [1/40], Step [900/1001], Loss: 3.5998, Perplexity: 36.5915, Time: 610.2999
Epoch [1/40], Step [1000/1001], Loss: 3.1639, Perplexity: 23.6634, Time: 642.3726
Epoch [2/40], Step [0/1001], Loss: 3.4934, Perplexity: 32.8976, Time: 643.0850
Epoch [2/40], Step [100/1001], Loss: 4.2947, Perplexity: 73.3109, Time: 675.2649
Epoch [2/40], Step [200/1001], Loss: 4.2927, Perplexity: 73.1613, Time: 706.8009
Epoch [2/40], Step [300/1001], Loss: 3.2910, Perplexity: 26.8700, Time: 738.3200
Epoch [2/40], Step [400/1001], Loss: 4.0837, Perplexity: 59.3666, Time: 770.4290
Epoch [2/40], Step [500/1001], Loss: 3.8067, Perplexity: 45.0021, Time: 801.2789
Epoch [2/40], Step [600/1001], Loss: 3.8371, Perplexity: 46.3904, Time: 833.0597
Epoch [2/40], Step [700/1001], Loss: 4.5559, Perplexity: 95.1936, Time: 864.5067
Epoch [2/40], Step [800/1001], Loss: 4.1283, Perplexity: 62.0707, Time: 896.1196
Epoch [2/40], Step [900/1001], Loss: 3.8578, Perplexity: 47.3632, Time: 927.6940
Epoch [2/40], Step [1000/1001], Loss: 3.4283, Perplexity: 30.8239, Time: 959.9515
Epoch [3/40], Step [0/1001], Loss: 3.9384, Perplexity: 51.3365, Time: 960.6166
Epoch [3/40], Step [100/1001], Loss: 3.9585, Perplexity: 52.3784, Time: 992.1265
Epoch [3/40], Step [200/1001], Loss: 2.4716, Perplexity: 11.8419, Time: 1023.7128
Epoch [3/40], Step [300/1001], Loss: 4.7853, Perplexity: 119.7356, Time: 1055.0897
Epoch [3/40], Step [400/1001], Loss: 4.2358, Perplexity: 69.1182, Time: 1086.6186
Epoch [3/40], Step [500/1001], Loss: 4.0753, Perplexity: 58.8669, Time: 1118.1888
Epoch [3/40], Step [600/1001], Loss: 4.6039, Perplexity: 99.8718, Time: 1150.2075
Epoch [3/40], Step [700/1001], Loss: 4.1235, Perplexity: 61.7742, Time: 1182.1890
Epoch [3/40], Step [800/1001], Loss: 4.2536, Perplexity: 70.3565, Time: 1214.1721
Epoch [3/40], Step [900/1001], Loss: 4.5546, Perplexity: 95.0652, Time: 1246.2194
Epoch [3/40], Step [1000/1001], Loss: 4.7007, Perplexity: 110.0190, Time: 1277.8245
Epoch [4/40], Step [0/1001], Loss: 3.5311, Perplexity: 34.1614, Time: 1278.5268
Epoch [4/40], Step [100/1001], Loss: 4.7107, Perplexity: 111.1303, Time: 1310.2856
Epoch [4/40], Step [200/1001], Loss: 4.3975, Perplexity: 81.2442, Time: 1342.2271
Epoch [4/40], Step [300/1001], Loss: 4.4038, Perplexity: 81.7592, Time: 1374.0385
Epoch [4/40], Step [400/1001], Loss: 4.6595, Perplexity: 105.5867, Time: 1405.4199
Epoch [4/40], Step [500/1001], Loss: 4.3988, Perplexity: 81.3518, Time: 1437.3626
Epoch [4/40], Step [600/1001], Loss: 3.7152, Perplexity: 41.0674, Time: 1469.0704
Epoch [4/40], Step [700/1001], Loss: 4.3823, Perplexity: 80.0234, Time: 1501.0244
Epoch [4/40], Step [800/1001], Loss: 4.2094, Perplexity: 67.3149, Time: 1532.7704
Epoch [4/40], Step [900/1001], Loss: 4.3753, Perplexity: 79.4624, Time: 1565.1521
Epoch [4/40], Step [1000/1001], Loss: 4.8891, Perplexity: 132.8327, Time: 1596.3994
Epoch [5/40], Step [0/1001], Loss: 4.6939, Perplexity: 109.2823, Time: 1597.0430
Epoch [5/40], Step [100/1001], Loss: 4.5369, Perplexity: 93.3962, Time: 1628.5529
Epoch [5/40], Step [200/1001], Loss: 3.9333, Perplexity: 51.0742, Time: 1659.9915
Epoch [5/40], Step [300/1001], Loss: 3.8508, Perplexity: 47.0292, Time: 1691.7427
Epoch [5/40], Step [400/1001], Loss: 3.3231, Perplexity: 27.7451, Time: 1723.2881
Epoch [5/40], Step [500/1001], Loss: 4.0297, Perplexity: 56.2429, Time: 1755.3327
Epoch [5/40], Step [600/1001], Loss: 4.2920, Perplexity: 73.1144, Time: 1786.9569
Epoch [5/40], Step [700/1001], Loss: 4.3702, Perplexity: 79.0632, Time: 1818.6445
Epoch [5/40], Step [800/1001], Loss: 4.0685, Perplexity: 58.4684, Time: 1850.2356
Epoch [5/40], Step [900/1001], Loss: 4.1867, Perplexity: 65.8073, Time: 1881.7858
Epoch [5/40], Step [1000/1001], Loss: 4.3925, Perplexity: 80.8384, Time: 1913.9727
Epoch [6/40], Step [0/1001], Loss: 4.0551, Perplexity: 57.6923, Time: 1914.6787
Epoch [6/40], Step [100/1001], Loss: 4.4362, Perplexity: 84.4564, Time: 1946.2005
Epoch [6/40], Step [200/1001], Loss: 3.8063, Perplexity: 44.9818, Time: 1977.7879
Epoch [6/40], Step [300/1001], Loss: 3.2052, Perplexity: 24.6616, Time: 2009.4243
Epoch [6/40], Step [400/1001], Loss: 3.2369, Perplexity: 25.4535, Time: 2041.3611
Epoch [6/40], Step [500/1001], Loss: 4.6285, Perplexity: 102.3637, Time: 2073.5180
Epoch [6/40], Step [600/1001], Loss: 4.2316, Perplexity: 68.8264, Time: 2104.9983
Epoch [6/40], Step [700/1001], Loss: 2.5045, Perplexity: 12.2372, Time: 2136.8821
Epoch [6/40], Step [800/1001], Loss: 3.9887, Perplexity: 53.9854, Time: 2169.0218
Epoch [6/40], Step [900/1001], Loss: 3.2257, Perplexity: 25.1717, Time: 2200.8396
Epoch [6/40], Step [1000/1001], Loss: 4.8285, Perplexity: 125.0257, Time: 2232.2729
Epoch [7/40], Step [0/1001], Loss: 4.2453, Perplexity: 69.7772, Time: 2232.9515
Epoch [7/40], Step [100/1001], Loss: 4.4880, Perplexity: 88.9447, Time: 2264.5887
Epoch [7/40], Step [200/1001], Loss: 4.3556, Perplexity: 77.9117, Time: 2295.9034
Epoch [7/40], Step [300/1001], Loss: 4.7570, Perplexity: 116.3927, Time: 2327.6430
Epoch [7/40], Step [400/1001], Loss: 4.5534, Perplexity: 94.9566, Time: 2360.0817
Epoch [7/40], Step [500/1001], Loss: 4.0170, Perplexity: 55.5325, Time: 2391.9654
Epoch [7/40], Step [600/1001], Loss: 4.0547, Perplexity: 57.6694, Time: 2423.9085
Epoch [7/40], Step [700/1001], Loss: 4.5163, Perplexity: 91.4974, Time: 2455.9122
Epoch [7/40], Step [800/1001], Loss: 4.2705, Perplexity: 71.5558, Time: 2487.6357
Epoch [7/40], Step [900/1001], Loss: 4.1111, Perplexity: 61.0160, Time: 2518.8029
Epoch [7/40], Step [1000/1001], Loss: 4.8183, Perplexity: 123.7511, Time: 2550.4870
Epoch [8/40], Step [0/1001], Loss: 5.1087, Perplexity: 165.4631, Time: 2551.0861
Epoch [8/40], Step [100/1001], Loss: 3.5218, Perplexity: 33.8455, Time: 2583.0871
Epoch [8/40], Step [200/1001], Loss: 4.4687, Perplexity: 87.2403, Time: 2615.2207
Epoch [8/40], Step [300/1001], Loss: 3.9229, Perplexity: 50.5450, Time: 2646.8205
Epoch [8/40], Step [400/1001], Loss: 4.4716, Perplexity: 87.4946, Time: 2678.7692
Epoch [8/40], Step [500/1001], Loss: 3.8039, Perplexity: 44.8759, Time: 2710.2351
Epoch [8/40], Step [600/1001], Loss: 4.2051, Perplexity: 67.0294, Time: 2742.1675
Epoch [8/40], Step [700/1001], Loss: 4.5077, Perplexity: 90.7151, Time: 2774.3094
Epoch [8/40], Step [800/1001], Loss: 2.8190, Perplexity: 16.7594, Time: 2805.9106
Epoch [8/40], Step [900/1001], Loss: 4.8402, Perplexity: 126.4897, Time: 2837.8885
Epoch [8/40], Step [1000/1001], Loss: 4.4962, Perplexity: 89.6770, Time: 2869.2566
Epoch [9/40], Step [0/1001], Loss: 4.8576, Perplexity: 128.7117, Time: 2869.9296
Epoch [9/40], Step [100/1001], Loss: 4.4340, Perplexity: 84.2656, Time: 2901.5925
Epoch [9/40], Step [200/1001], Loss: 4.3781, Perplexity: 79.6855, Time: 2933.5797
Epoch [9/40], Step [300/1001], Loss: 4.1330, Perplexity: 62.3678, Time: 2965.3337
Epoch [9/40], Step [400/1001], Loss: 4.0496, Perplexity: 57.3733, Time: 2997.2351
Epoch [9/40], Step [500/1001], Loss: 4.2520, Perplexity: 70.2451, Time: 3028.9780
Epoch [9/40], Step [600/1001], Loss: 4.2604, Perplexity: 70.8382, Time: 3061.5447
Epoch [9/40], Step [700/1001], Loss: 4.7750, Perplexity: 118.5080, Time: 3093.1760
Epoch [9/40], Step [800/1001], Loss: 4.2445, Perplexity: 69.7230, Time: 3125.1236
Epoch [9/40], Step [900/1001], Loss: 4.0730, Perplexity: 58.7305, Time: 3157.0118
Epoch [9/40], Step [1000/1001], Loss: 4.5308, Perplexity: 92.8363, Time: 3188.4863
Epoch [10/40], Step [0/1001], Loss: 3.9112, Perplexity: 49.9589, Time: 3189.1952
Epoch [10/40], Step [100/1001], Loss: 4.0346, Perplexity: 56.5176, Time: 3221.0337
Epoch [10/40], Step [200/1001], Loss: 4.2676, Perplexity: 71.3520, Time: 3252.7496
Epoch [10/40], Step [300/1001], Loss: 4.3249, Perplexity: 75.5617, Time: 3284.3094
Epoch [10/40], Step [400/1001], Loss: 3.9038, Perplexity: 49.5920, Time: 3316.1390
Epoch [10/40], Step [500/1001], Loss: 4.4059, Perplexity: 81.9311, Time: 3347.7305
Epoch [10/40], Step [600/1001], Loss: 4.9137, Perplexity: 136.1456, Time: 3379.3909
Epoch [10/40], Step [700/1001], Loss: 3.8188, Perplexity: 45.5514, Time: 3410.9380
Epoch [10/40], Step [800/1001], Loss: 3.7936, Perplexity: 44.4139, Time: 3442.9708
Epoch [10/40], Step [900/1001], Loss: 4.2840, Perplexity: 72.5282, Time: 3475.2371
Epoch [10/40], Step [1000/1001], Loss: 4.7225, Perplexity: 112.4476, Time: 3506.9225
Epoch [11/40], Step [0/1001], Loss: 4.1163, Perplexity: 61.3335, Time: 3507.6094
Epoch [11/40], Step [100/1001], Loss: 4.0598, Perplexity: 57.9601, Time: 3539.1820
Epoch [11/40], Step [200/1001], Loss: 4.2888, Perplexity: 72.8802, Time: 3570.7363
Epoch [11/40], Step [300/1001], Loss: 3.7592, Perplexity: 42.9142, Time: 3602.7750
Epoch [11/40], Step [400/1001], Loss: 3.8815, Perplexity: 48.4962, Time: 3634.7998
Epoch [11/40], Step [500/1001], Loss: 3.6444, Perplexity: 38.2601, Time: 3666.9015
Epoch [11/40], Step [600/1001], Loss: 3.9279, Perplexity: 50.7997, Time: 3698.5900
Epoch [11/40], Step [700/1001], Loss: 3.7717, Perplexity: 43.4554, Time: 3730.8206
Epoch [11/40], Step [800/1001], Loss: 4.7193, Perplexity: 112.0927, Time: 3762.5309
Epoch [11/40], Step [900/1001], Loss: 3.8200, Perplexity: 45.6049, Time: 3794.2632
Epoch [11/40], Step [1000/1001], Loss: 4.6042, Perplexity: 99.9028, Time: 3825.7470
Epoch [12/40], Step [0/1001], Loss: 4.2687, Perplexity: 71.4281, Time: 3826.4416
Epoch [12/40], Step [100/1001], Loss: 3.8733, Perplexity: 48.1015, Time: 3858.0884
Epoch [12/40], Step [200/1001], Loss: 4.6728, Perplexity: 106.9921, Time: 3889.2489
Epoch [12/40], Step [300/1001], Loss: 4.6068, Perplexity: 100.1644, Time: 3921.2234
Epoch [12/40], Step [400/1001], Loss: 3.6669, Perplexity: 39.1310, Time: 3952.6441
Epoch [12/40], Step [500/1001], Loss: 4.0258, Perplexity: 56.0249, Time: 3984.0932
Epoch [12/40], Step [600/1001], Loss: 4.6911, Perplexity: 108.9733, Time: 4015.7882
Epoch [12/40], Step [700/1001], Loss: 4.5123, Perplexity: 91.1341, Time: 4047.6229
Epoch [12/40], Step [800/1001], Loss: 3.3425, Perplexity: 28.2898, Time: 4079.6370
Epoch [12/40], Step [900/1001], Loss: 3.8385, Perplexity: 46.4535, Time: 4111.8716
Epoch [12/40], Step [1000/1001], Loss: 4.7661, Perplexity: 117.4660, Time: 4143.5460
Epoch [13/40], Step [0/1001], Loss: 4.0224, Perplexity: 55.8352, Time: 4144.2939
Epoch [13/40], Step [100/1001], Loss: 4.2198, Perplexity: 68.0186, Time: 4175.9492
Epoch [13/40], Step [200/1001], Loss: 2.3970, Perplexity: 10.9901, Time: 4207.5256
Epoch [13/40], Step [300/1001], Loss: 4.2623, Perplexity: 70.9763, Time: 4238.7032
Epoch [13/40], Step [400/1001], Loss: 2.2579, Perplexity: 9.5625, Time: 4270.5294
Epoch [13/40], Step [500/1001], Loss: 3.8770, Perplexity: 48.2774, Time: 4302.3438
Epoch [13/40], Step [600/1001], Loss: 4.5709, Perplexity: 96.6333, Time: 4334.6484
Epoch [13/40], Step [700/1001], Loss: 4.1500, Perplexity: 63.4342, Time: 4366.2945
Epoch [13/40], Step [800/1001], Loss: 3.9689, Perplexity: 52.9270, Time: 4397.9604
Epoch [13/40], Step [900/1001], Loss: 3.7589, Perplexity: 42.9016, Time: 4430.3771
Epoch [13/40], Step [1000/1001], Loss: 4.9664, Perplexity: 143.5107, Time: 4461.6863
Epoch [14/40], Step [0/1001], Loss: 3.9207, Perplexity: 50.4375, Time: 4462.3774
Epoch [14/40], Step [100/1001], Loss: 4.2987, Perplexity: 73.6024, Time: 4493.9109
Epoch [14/40], Step [200/1001], Loss: 4.4788, Perplexity: 88.1269, Time: 4525.4930
Epoch [14/40], Step [300/1001], Loss: 4.0486, Perplexity: 57.3170, Time: 4557.2411
Epoch [14/40], Step [400/1001], Loss: 2.6002, Perplexity: 13.4662, Time: 4589.3985
Epoch [14/40], Step [500/1001], Loss: 4.2404, Perplexity: 69.4356, Time: 4621.2666
Epoch [14/40], Step [600/1001], Loss: 4.0106, Perplexity: 55.1805, Time: 4653.6971
Epoch [14/40], Step [700/1001], Loss: 3.4801, Perplexity: 32.4639, Time: 4685.1342
Epoch [14/40], Step [800/1001], Loss: 3.7834, Perplexity: 43.9646, Time: 4716.4978
Epoch [14/40], Step [900/1001], Loss: 3.8816, Perplexity: 48.5004, Time: 4748.1311
Epoch [14/40], Step [1000/1001], Loss: 4.7396, Perplexity: 114.3868, Time: 4779.4350
Epoch [15/40], Step [0/1001], Loss: 4.3058, Perplexity: 74.1294, Time: 4780.0994
Epoch [15/40], Step [100/1001], Loss: 4.6623, Perplexity: 105.8813, Time: 4811.7862
Epoch [15/40], Step [200/1001], Loss: 4.6648, Perplexity: 106.1468, Time: 4843.6203
Epoch [15/40], Step [300/1001], Loss: 3.9679, Perplexity: 52.8731, Time: 4875.7298
Epoch [15/40], Step [400/1001], Loss: 3.1903, Perplexity: 24.2955, Time: 4907.2656
Epoch [15/40], Step [500/1001], Loss: 3.9127, Perplexity: 50.0352, Time: 4938.8674
Epoch [15/40], Step [600/1001], Loss: 3.8715, Perplexity: 48.0127, Time: 4970.4215
Epoch [15/40], Step [700/1001], Loss: 4.1221, Perplexity: 61.6916, Time: 5002.5392
Epoch [15/40], Step [800/1001], Loss: 4.3772, Perplexity: 79.6123, Time: 5034.3055
Epoch [15/40], Step [900/1001], Loss: 4.3584, Perplexity: 78.1286, Time: 5066.0487
Epoch [15/40], Step [1000/1001], Loss: 3.5418, Perplexity: 34.5276, Time: 5097.6663
Epoch [16/40], Step [0/1001], Loss: 4.0242, Perplexity: 55.9354, Time: 5098.3405
Epoch [16/40], Step [100/1001], Loss: 3.6215, Perplexity: 37.3935, Time: 5132.3891
Epoch [16/40], Step [200/1001], Loss: 4.6068, Perplexity: 100.1582, Time: 5163.9710
Epoch [16/40], Step [300/1001], Loss: 4.2633, Perplexity: 71.0456, Time: 5195.7493
Epoch [16/40], Step [400/1001], Loss: 3.8679, Perplexity: 47.8410, Time: 5227.7207
Epoch [16/40], Step [500/1001], Loss: 4.6194, Perplexity: 101.4324, Time: 5259.4180
Epoch [16/40], Step [600/1001], Loss: 4.5166, Perplexity: 91.5274, Time: 5291.3593
Epoch [16/40], Step [700/1001], Loss: 3.5565, Perplexity: 35.0401, Time: 5323.3707
Epoch [16/40], Step [800/1001], Loss: 4.2614, Perplexity: 70.9106, Time: 5355.1356
Epoch [16/40], Step [900/1001], Loss: 3.1280, Perplexity: 22.8292, Time: 5387.3729
Epoch [16/40], Step [1000/1001], Loss: 4.5149, Perplexity: 91.3668, Time: 5419.3433
Epoch [17/40], Step [0/1001], Loss: 3.1751, Perplexity: 23.9280, Time: 5420.0823
Epoch [17/40], Step [100/1001], Loss: 3.4667, Perplexity: 32.0298, Time: 5451.6873
Epoch [17/40], Step [200/1001], Loss: 2.2651, Perplexity: 9.6318, Time: 5483.4824
Epoch [17/40], Step [300/1001], Loss: 4.5147, Perplexity: 91.3528, Time: 5515.0372
Epoch [17/40], Step [400/1001], Loss: 4.0305, Perplexity: 56.2864, Time: 5547.1311
Epoch [17/40], Step [500/1001], Loss: 4.4521, Perplexity: 85.8038, Time: 5578.8199
Epoch [17/40], Step [600/1001], Loss: 4.9839, Perplexity: 146.0486, Time: 5610.3287
Epoch [17/40], Step [700/1001], Loss: 4.1264, Perplexity: 61.9543, Time: 5642.0942
Epoch [17/40], Step [800/1001], Loss: 4.3793, Perplexity: 79.7842, Time: 5673.8785
Epoch [17/40], Step [900/1001], Loss: 4.6433, Perplexity: 103.8856, Time: 5705.8317
Epoch [17/40], Step [1000/1001], Loss: 3.7755, Perplexity: 43.6174, Time: 5737.3627
Epoch [18/40], Step [0/1001], Loss: 3.9093, Perplexity: 49.8662, Time: 5738.0512
Epoch [18/40], Step [100/1001], Loss: 3.5568, Perplexity: 35.0499, Time: 5769.9384
Epoch [18/40], Step [200/1001], Loss: 4.5317, Perplexity: 92.9144, Time: 5801.4424
Epoch [18/40], Step [300/1001], Loss: 4.1108, Perplexity: 60.9957, Time: 5833.0242
Epoch [18/40], Step [400/1001], Loss: 4.7127, Perplexity: 111.3575, Time: 5864.6914
Epoch [18/40], Step [500/1001], Loss: 3.9153, Perplexity: 50.1651, Time: 5896.5249
Epoch [18/40], Step [600/1001], Loss: 4.2615, Perplexity: 70.9198, Time: 5928.2139
Epoch [18/40], Step [700/1001], Loss: 4.1682, Perplexity: 64.5985, Time: 5959.9545
Epoch [18/40], Step [800/1001], Loss: 4.6525, Perplexity: 104.8491, Time: 5991.5499
Epoch [18/40], Step [900/1001], Loss: 3.8360, Perplexity: 46.3379, Time: 6023.1341
Epoch [18/40], Step [1000/1001], Loss: 4.0671, Perplexity: 58.3861, Time: 6054.7072
Epoch [19/40], Step [0/1001], Loss: 3.8645, Perplexity: 47.6778, Time: 6055.3916
Epoch [19/40], Step [100/1001], Loss: 4.4611, Perplexity: 86.5791, Time: 6086.8780
Epoch [19/40], Step [200/1001], Loss: 4.3628, Perplexity: 78.4728, Time: 6118.5672
Epoch [19/40], Step [300/1001], Loss: 4.4159, Perplexity: 82.7580, Time: 6150.5212
Epoch [19/40], Step [400/1001], Loss: 4.3318, Perplexity: 76.0842, Time: 6182.0507
Epoch [19/40], Step [500/1001], Loss: 4.1033, Perplexity: 60.5389, Time: 6213.6156
Epoch [19/40], Step [600/1001], Loss: 4.4444, Perplexity: 85.1507, Time: 6245.4341
Epoch [19/40], Step [700/1001], Loss: 3.8420, Perplexity: 46.6191, Time: 6277.1862
Epoch [19/40], Step [800/1001], Loss: 3.8638, Perplexity: 47.6445, Time: 6308.9226
Epoch [19/40], Step [900/1001], Loss: 4.6795, Perplexity: 107.7164, Time: 6340.5213
Epoch [19/40], Step [1000/1001], Loss: 4.4585, Perplexity: 86.3590, Time: 6372.3921
Epoch [20/40], Step [0/1001], Loss: 3.5407, Perplexity: 34.4901, Time: 6373.2161
Epoch [20/40], Step [100/1001], Loss: 3.9119, Perplexity: 49.9915, Time: 6405.1240
Epoch [20/40], Step [200/1001], Loss: 3.8431, Perplexity: 46.6689, Time: 6436.7305
Epoch [20/40], Step [300/1001], Loss: 4.2285, Perplexity: 68.6140, Time: 6468.2569
Epoch [20/40], Step [400/1001], Loss: 4.6475, Perplexity: 104.3273, Time: 6500.0863
Epoch [20/40], Step [500/1001], Loss: 4.3196, Perplexity: 75.1549, Time: 6532.3411
Epoch [20/40], Step [600/1001], Loss: 3.3196, Perplexity: 27.6496, Time: 6563.9667
Epoch [20/40], Step [700/1001], Loss: 4.2293, Perplexity: 68.6706, Time: 6595.9799
Epoch [20/40], Step [800/1001], Loss: 4.2280, Perplexity: 68.5813, Time: 6627.8614
Epoch [20/40], Step [900/1001], Loss: 3.6614, Perplexity: 38.9177, Time: 6659.2374
Epoch [20/40], Step [1000/1001], Loss: 4.5588, Perplexity: 95.4697, Time: 6691.0291
Epoch [21/40], Step [0/1001], Loss: 3.9137, Perplexity: 50.0854, Time: 6691.7423
Epoch [21/40], Step [100/1001], Loss: 3.6681, Perplexity: 39.1771, Time: 6723.5734
Epoch [21/40], Step [200/1001], Loss: 4.2346, Perplexity: 69.0371, Time: 6755.4265
Epoch [21/40], Step [300/1001], Loss: 3.3606, Perplexity: 28.8067, Time: 6787.0771
Epoch [21/40], Step [400/1001], Loss: 4.0805, Perplexity: 59.1780, Time: 6818.8731
Epoch [21/40], Step [500/1001], Loss: 3.8580, Perplexity: 47.3687, Time: 6850.7165
Epoch [21/40], Step [600/1001], Loss: 4.4506, Perplexity: 85.6774, Time: 6882.2119
Epoch [21/40], Step [700/1001], Loss: 3.8348, Perplexity: 46.2859, Time: 6913.8825
Epoch [21/40], Step [800/1001], Loss: 4.6504, Perplexity: 104.6245, Time: 6945.5492
Epoch [21/40], Step [900/1001], Loss: 4.3583, Perplexity: 78.1277, Time: 6977.6862
Epoch [21/40], Step [1000/1001], Loss: 3.8009, Perplexity: 44.7394, Time: 7009.1381
Epoch [22/40], Step [0/1001], Loss: 4.8875, Perplexity: 132.6175, Time: 7009.8050
Epoch [22/40], Step [100/1001], Loss: 4.3070, Perplexity: 74.2209, Time: 7041.6607
Epoch [22/40], Step [200/1001], Loss: 3.3413, Perplexity: 28.2571, Time: 7073.0722
Epoch [22/40], Step [300/1001], Loss: 3.8201, Perplexity: 45.6075, Time: 7104.5694
Epoch [22/40], Step [400/1001], Loss: 4.2464, Perplexity: 69.8507, Time: 7136.5205
Epoch [22/40], Step [500/1001], Loss: 3.9366, Perplexity: 51.2457, Time: 7168.3637
Epoch [22/40], Step [600/1001], Loss: 4.4026, Perplexity: 81.6653, Time: 7199.8425
Epoch [22/40], Step [700/1001], Loss: 4.0357, Perplexity: 56.5808, Time: 7231.5684
Epoch [22/40], Step [800/1001], Loss: 4.2988, Perplexity: 73.6102, Time: 7263.2395
Epoch [22/40], Step [900/1001], Loss: 3.6248, Perplexity: 37.5172, Time: 7295.0927
Epoch [22/40], Step [1000/1001], Loss: 4.0844, Perplexity: 59.4084, Time: 7326.9574
Epoch [23/40], Step [0/1001], Loss: 4.1885, Perplexity: 65.9222, Time: 7327.7972
Epoch [23/40], Step [100/1001], Loss: 4.6439, Perplexity: 103.9484, Time: 7359.4433
Epoch [23/40], Step [200/1001], Loss: 3.6186, Perplexity: 37.2847, Time: 7391.2460
Epoch [23/40], Step [300/1001], Loss: 3.2588, Perplexity: 26.0185, Time: 7423.0410
Epoch [23/40], Step [400/1001], Loss: 4.1382, Perplexity: 62.6881, Time: 7454.9120
Epoch [23/40], Step [500/1001], Loss: 4.0803, Perplexity: 59.1639, Time: 7486.3555
Epoch [23/40], Step [600/1001], Loss: 4.8717, Perplexity: 130.5414, Time: 7517.6172
Epoch [23/40], Step [700/1001], Loss: 4.1277, Perplexity: 62.0339, Time: 7549.5668
Epoch [23/40], Step [800/1001], Loss: 3.3044, Perplexity: 27.2310, Time: 7581.1131
Epoch [23/40], Step [900/1001], Loss: 4.4751, Perplexity: 87.8025, Time: 7612.8144
Epoch [23/40], Step [1000/1001], Loss: 6.0319, Perplexity: 416.4869, Time: 7644.6766
Epoch [24/40], Step [0/1001], Loss: 4.9085, Perplexity: 135.4365, Time: 7645.3387
Epoch [24/40], Step [100/1001], Loss: 4.9424, Perplexity: 140.1006, Time: 7682.3504
Epoch [24/40], Step [200/1001], Loss: 4.8727, Perplexity: 130.6786, Time: 7713.4669
Epoch [24/40], Step [300/1001], Loss: 5.0901, Perplexity: 162.3991, Time: 7748.0227
Epoch [24/40], Step [400/1001], Loss: 4.1474, Perplexity: 63.2677, Time: 7780.1905
Epoch [24/40], Step [500/1001], Loss: 5.2059, Perplexity: 182.3473, Time: 7812.3914
Epoch [24/40], Step [600/1001], Loss: 4.3629, Perplexity: 78.4871, Time: 7844.2315
Epoch [24/40], Step [700/1001], Loss: 4.1612, Perplexity: 64.1482, Time: 7876.0407
Epoch [24/40], Step [800/1001], Loss: 4.6121, Perplexity: 100.6981, Time: 7908.1491
Epoch [24/40], Step [900/1001], Loss: 4.5803, Perplexity: 97.5431, Time: 7939.9764
Epoch [24/40], Step [1000/1001], Loss: 4.4364, Perplexity: 84.4710, Time: 7971.4422
Epoch [25/40], Step [0/1001], Loss: 4.4398, Perplexity: 84.7559, Time: 7972.1266
Epoch [25/40], Step [100/1001], Loss: 5.0967, Perplexity: 163.4877, Time: 8003.7436
Epoch [25/40], Step [200/1001], Loss: 4.3940, Perplexity: 80.9656, Time: 8035.6555
Epoch [25/40], Step [300/1001], Loss: 4.4514, Perplexity: 85.7454, Time: 8067.7774
Epoch [25/40], Step [400/1001], Loss: 4.7753, Perplexity: 118.5421, Time: 8099.2680
Epoch [25/40], Step [500/1001], Loss: 4.5598, Perplexity: 95.5600, Time: 8131.0647
Epoch [25/40], Step [600/1001], Loss: 4.7696, Perplexity: 117.8670, Time: 8162.8152
Epoch [25/40], Step [700/1001], Loss: 4.4412, Perplexity: 84.8756, Time: 8194.8416
Epoch [25/40], Step [800/1001], Loss: 4.1791, Perplexity: 65.3048, Time: 8227.1494
Epoch [25/40], Step [900/1001], Loss: 4.1232, Perplexity: 61.7591, Time: 8259.0592
Epoch [25/40], Step [1000/1001], Loss: 4.9666, Perplexity: 143.5423, Time: 8290.8257
Epoch [26/40], Step [0/1001], Loss: 4.5557, Perplexity: 95.1737, Time: 8291.5620
Epoch [26/40], Step [100/1001], Loss: 4.3657, Perplexity: 78.7033, Time: 8323.2317
Epoch [26/40], Step [200/1001], Loss: 4.5503, Perplexity: 94.6597, Time: 8355.6265
Epoch [26/40], Step [300/1001], Loss: 4.2209, Perplexity: 68.0965, Time: 8387.4972
Epoch [26/40], Step [400/1001], Loss: 4.2757, Perplexity: 71.9306, Time: 8419.2598
Epoch [26/40], Step [500/1001], Loss: 4.0978, Perplexity: 60.2073, Time: 8451.1852
Epoch [26/40], Step [600/1001], Loss: 4.0662, Perplexity: 58.3353, Time: 8483.0449
Epoch [26/40], Step [700/1001], Loss: 4.3670, Perplexity: 78.8044, Time: 8514.8894
Epoch [26/40], Step [800/1001], Loss: 3.7212, Perplexity: 41.3159, Time: 8546.4953
Epoch [26/40], Step [900/1001], Loss: 4.6800, Perplexity: 107.7685, Time: 8578.3407
Epoch [26/40], Step [1000/1001], Loss: 4.8081, Perplexity: 122.4966, Time: 8610.1789
Epoch [27/40], Step [0/1001], Loss: 3.3602, Perplexity: 28.7948, Time: 8610.9230
Epoch [27/40], Step [100/1001], Loss: 4.4824, Perplexity: 88.4491, Time: 8642.6004
Epoch [27/40], Step [200/1001], Loss: 4.3379, Perplexity: 76.5473, Time: 8674.2817
Epoch [27/40], Step [300/1001], Loss: 4.8239, Perplexity: 124.4467, Time: 8706.2481
Epoch [27/40], Step [400/1001], Loss: 4.7392, Perplexity: 114.3407, Time: 8738.1675
Epoch [27/40], Step [500/1001], Loss: 4.5091, Perplexity: 90.8418, Time: 8770.2780
Epoch [27/40], Step [600/1001], Loss: 3.5145, Perplexity: 33.5999, Time: 8801.7436
Epoch [27/40], Step [700/1001], Loss: 4.7414, Perplexity: 114.5897, Time: 8833.3774
Epoch [27/40], Step [800/1001], Loss: 4.1199, Perplexity: 61.5512, Time: 8865.2549
Epoch [27/40], Step [900/1001], Loss: 4.5005, Perplexity: 90.0631, Time: 8896.8615
Epoch [27/40], Step [1000/1001], Loss: 4.8734, Perplexity: 130.7692, Time: 8928.3846
Epoch [28/40], Step [0/1001], Loss: 4.1736, Perplexity: 64.9492, Time: 8929.3965
Epoch [28/40], Step [100/1001], Loss: 4.2138, Perplexity: 67.6143, Time: 8962.4981
Epoch [28/40], Step [200/1001], Loss: 3.4654, Perplexity: 31.9887, Time: 8994.1271
Epoch [28/40], Step [300/1001], Loss: 3.6684, Perplexity: 39.1893, Time: 9026.0091
Epoch [28/40], Step [400/1001], Loss: 4.1342, Perplexity: 62.4418, Time: 9058.1159
Epoch [28/40], Step [500/1001], Loss: 4.8986, Perplexity: 134.1020, Time: 9090.0027
Epoch [28/40], Step [600/1001], Loss: 4.8376, Perplexity: 126.1690, Time: 9121.4832
Epoch [28/40], Step [700/1001], Loss: 4.5759, Perplexity: 97.1155, Time: 9153.4784
Epoch [28/40], Step [800/1001], Loss: 3.6080, Perplexity: 36.8911, Time: 9185.4139
Epoch [28/40], Step [900/1001], Loss: 4.8134, Perplexity: 123.1435, Time: 9217.3098
Epoch [28/40], Step [1000/1001], Loss: 4.5903, Perplexity: 98.5283, Time: 9249.0853
Epoch [29/40], Step [0/1001], Loss: 4.3499, Perplexity: 77.4711, Time: 9249.7964
Epoch [29/40], Step [100/1001], Loss: 4.0136, Perplexity: 55.3479, Time: 9281.6831
Epoch [29/40], Step [200/1001], Loss: 2.2600, Perplexity: 9.5835, Time: 9313.6155
Epoch [29/40], Step [300/1001], Loss: 3.9129, Perplexity: 50.0464, Time: 9345.0946
Epoch [29/40], Step [400/1001], Loss: 5.0476, Perplexity: 155.6435, Time: 9376.3944
Epoch [29/40], Step [500/1001], Loss: 4.4976, Perplexity: 89.7969, Time: 9407.9771
Epoch [29/40], Step [600/1001], Loss: 3.4459, Perplexity: 31.3711, Time: 9439.7950
Epoch [29/40], Step [700/1001], Loss: 3.0952, Perplexity: 22.0926, Time: 9471.8071
Epoch [29/40], Step [800/1001], Loss: 4.3550, Perplexity: 77.8652, Time: 9503.4124
Epoch [29/40], Step [900/1001], Loss: 4.1311, Perplexity: 62.2473, Time: 9535.3562
Epoch [29/40], Step [1000/1001], Loss: 5.0708, Perplexity: 159.3085, Time: 9567.3518
Epoch [30/40], Step [0/1001], Loss: 4.0528, Perplexity: 57.5606, Time: 9568.0733
Epoch [30/40], Step [100/1001], Loss: 3.6861, Perplexity: 39.8885, Time: 9600.0540
Epoch [30/40], Step [200/1001], Loss: 4.4852, Perplexity: 88.6966, Time: 9632.3815
Epoch [30/40], Step [300/1001], Loss: 4.3980, Perplexity: 81.2897, Time: 9663.9566
Epoch [30/40], Step [400/1001], Loss: 4.6067, Perplexity: 100.1548, Time: 9696.4049
Epoch [30/40], Step [500/1001], Loss: 4.3983, Perplexity: 81.3165, Time: 9729.4215
Epoch [30/40], Step [600/1001], Loss: 3.9556, Perplexity: 52.2277, Time: 9761.7317
Epoch [30/40], Step [700/1001], Loss: 4.5858, Perplexity: 98.0862, Time: 9794.0591
Epoch [30/40], Step [800/1001], Loss: 4.3860, Perplexity: 80.3145, Time: 9826.1603
Epoch [30/40], Step [900/1001], Loss: 4.4861, Perplexity: 88.7710, Time: 9858.2346
Epoch [30/40], Step [1000/1001], Loss: 4.4517, Perplexity: 85.7732, Time: 9890.6059
Epoch [31/40], Step [0/1001], Loss: 4.7508, Perplexity: 115.6807, Time: 9891.5948
Epoch [31/40], Step [100/1001], Loss: 4.1892, Perplexity: 65.9712, Time: 9923.6499
Epoch [31/40], Step [200/1001], Loss: 4.2111, Perplexity: 67.4298, Time: 9955.9711
Epoch [31/40], Step [300/1001], Loss: 4.7860, Perplexity: 119.8241, Time: 9988.1593
Epoch [31/40], Step [400/1001], Loss: 3.6578, Perplexity: 38.7750, Time: 10020.4776
Epoch [31/40], Step [500/1001], Loss: 4.7399, Perplexity: 114.4256, Time: 10053.2636
Epoch [31/40], Step [600/1001], Loss: 4.5953, Perplexity: 99.0154, Time: 10085.6401
Epoch [31/40], Step [700/1001], Loss: 3.5288, Perplexity: 34.0846, Time: 10117.7060
Epoch [31/40], Step [800/1001], Loss: 4.1268, Perplexity: 61.9810, Time: 10150.1281
Epoch [31/40], Step [900/1001], Loss: 3.8934, Perplexity: 49.0763, Time: 10182.2908
Epoch [31/40], Step [1000/1001], Loss: 3.9925, Perplexity: 54.1888, Time: 10213.8481
Epoch [32/40], Step [0/1001], Loss: 4.1854, Perplexity: 65.7212, Time: 10214.8422
Epoch [32/40], Step [100/1001], Loss: 3.8248, Perplexity: 45.8253, Time: 10246.6638
Epoch [32/40], Step [200/1001], Loss: 4.4611, Perplexity: 86.5870, Time: 10278.5858
Epoch [32/40], Step [300/1001], Loss: 4.5018, Perplexity: 90.1807, Time: 10311.2411
Epoch [32/40], Step [400/1001], Loss: 3.8083, Perplexity: 45.0753, Time: 10343.3464
Epoch [32/40], Step [500/1001], Loss: 4.6228, Perplexity: 101.7744, Time: 10375.5908
Epoch [32/40], Step [600/1001], Loss: 4.3841, Perplexity: 80.1644, Time: 10407.8500
Epoch [32/40], Step [700/1001], Loss: 4.1804, Perplexity: 65.3924, Time: 10439.8443
Epoch [32/40], Step [800/1001], Loss: 4.0331, Perplexity: 56.4375, Time: 10472.2118
Epoch [32/40], Step [900/1001], Loss: 4.7757, Perplexity: 118.5934, Time: 10504.3784
Epoch [32/40], Step [1000/1001], Loss: 4.2438, Perplexity: 69.6716, Time: 10536.3172
Epoch [33/40], Step [0/1001], Loss: 3.4832, Perplexity: 32.5631, Time: 10537.4474
Epoch [33/40], Step [100/1001], Loss: 4.5612, Perplexity: 95.6974, Time: 10569.5790
Epoch [33/40], Step [200/1001], Loss: 4.3900, Perplexity: 80.6376, Time: 10601.5181
Epoch [33/40], Step [300/1001], Loss: 4.5099, Perplexity: 90.9135, Time: 10634.0198
Epoch [33/40], Step [400/1001], Loss: 4.8714, Perplexity: 130.4973, Time: 10666.6601
Epoch [33/40], Step [500/1001], Loss: 4.4492, Perplexity: 85.5555, Time: 10699.0074
Epoch [33/40], Step [600/1001], Loss: 4.2894, Perplexity: 72.9254, Time: 10730.8161
Epoch [33/40], Step [700/1001], Loss: 4.3506, Perplexity: 77.5214, Time: 10762.9834
Epoch [33/40], Step [800/1001], Loss: 3.7746, Perplexity: 43.5789, Time: 10794.9465
Epoch [33/40], Step [900/1001], Loss: 3.2887, Perplexity: 26.8083, Time: 10827.4437
Epoch [33/40], Step [1000/1001], Loss: 4.5149, Perplexity: 91.3697, Time: 10859.0901
Epoch [34/40], Step [0/1001], Loss: 4.4690, Perplexity: 87.2737, Time: 10859.9420
Epoch [34/40], Step [100/1001], Loss: 3.6937, Perplexity: 40.1924, Time: 10892.0706
Epoch [34/40], Step [200/1001], Loss: 4.8835, Perplexity: 132.0974, Time: 10924.1333
Epoch [34/40], Step [300/1001], Loss: 4.3721, Perplexity: 79.2085, Time: 10956.0648
Epoch [34/40], Step [400/1001], Loss: 4.0959, Perplexity: 60.0954, Time: 10988.3307
Epoch [34/40], Step [500/1001], Loss: 4.1254, Perplexity: 61.8939, Time: 11020.7513
Epoch [34/40], Step [600/1001], Loss: 3.5664, Perplexity: 35.3873, Time: 11053.0381
Epoch [34/40], Step [700/1001], Loss: 4.8523, Perplexity: 128.0392, Time: 11085.2363
Epoch [34/40], Step [800/1001], Loss: 4.6566, Perplexity: 105.2755, Time: 11117.3701
Epoch [34/40], Step [900/1001], Loss: 4.4801, Perplexity: 88.2436, Time: 11149.1730
Epoch [34/40], Step [1000/1001], Loss: 2.7897, Perplexity: 16.2753, Time: 11181.2956
Epoch [35/40], Step [0/1001], Loss: 3.4853, Perplexity: 32.6329, Time: 11182.3075
Epoch [35/40], Step [100/1001], Loss: 4.4305, Perplexity: 83.9750, Time: 11214.4299
Epoch [35/40], Step [200/1001], Loss: 3.8837, Perplexity: 48.6036, Time: 11246.6833
Epoch [35/40], Step [300/1001], Loss: 4.3908, Perplexity: 80.7021, Time: 11278.5801
Epoch [35/40], Step [400/1001], Loss: 4.4038, Perplexity: 81.7626, Time: 11311.3890
Epoch [35/40], Step [500/1001], Loss: 3.9842, Perplexity: 53.7444, Time: 11343.5394
Epoch [35/40], Step [600/1001], Loss: 3.7459, Perplexity: 42.3470, Time: 11375.7800
Epoch [35/40], Step [700/1001], Loss: 4.2631, Perplexity: 71.0290, Time: 11408.1312
Epoch [35/40], Step [800/1001], Loss: 4.2814, Perplexity: 72.3403, Time: 11440.3577
Epoch [35/40], Step [900/1001], Loss: 3.9114, Perplexity: 49.9668, Time: 11472.3549
Epoch [35/40], Step [1000/1001], Loss: 4.4340, Perplexity: 84.2637, Time: 11504.4348
Epoch [36/40], Step [0/1001], Loss: 3.9168, Perplexity: 50.2393, Time: 11505.4945
Epoch [36/40], Step [100/1001], Loss: 4.1413, Perplexity: 62.8861, Time: 11537.7265
Epoch [36/40], Step [200/1001], Loss: 3.8495, Perplexity: 46.9710, Time: 11569.6884
Epoch [36/40], Step [300/1001], Loss: 3.8290, Perplexity: 46.0175, Time: 11601.9980
Epoch [36/40], Step [400/1001], Loss: 4.0025, Perplexity: 54.7338, Time: 11634.0748
Epoch [36/40], Step [500/1001], Loss: 3.9985, Perplexity: 54.5139, Time: 11666.2139
Epoch [36/40], Step [600/1001], Loss: 4.1176, Perplexity: 61.4139, Time: 11698.9267
Epoch [36/40], Step [700/1001], Loss: 2.7287, Perplexity: 15.3129, Time: 11731.4708
Epoch [36/40], Step [800/1001], Loss: 4.2246, Perplexity: 68.3456, Time: 11763.8212
Epoch [36/40], Step [900/1001], Loss: 4.3066, Perplexity: 74.1876, Time: 11795.3646
Epoch [36/40], Step [1000/1001], Loss: 4.7924, Perplexity: 120.5931, Time: 11826.6207
Epoch [37/40], Step [0/1001], Loss: 4.5667, Perplexity: 96.2223, Time: 11827.2994
Epoch [37/40], Step [100/1001], Loss: 4.6485, Perplexity: 104.4271, Time: 11858.7064
Epoch [37/40], Step [200/1001], Loss: 2.9910, Perplexity: 19.9049, Time: 11890.7936
Epoch [37/40], Step [300/1001], Loss: 4.5385, Perplexity: 93.5545, Time: 11922.8935
Epoch [37/40], Step [400/1001], Loss: 3.5536, Perplexity: 34.9403, Time: 11954.7166
Epoch [37/40], Step [500/1001], Loss: 4.8386, Perplexity: 126.2926, Time: 11986.1533
Epoch [37/40], Step [600/1001], Loss: 4.8684, Perplexity: 130.1092, Time: 12018.0542
Epoch [37/40], Step [700/1001], Loss: 4.1451, Perplexity: 63.1223, Time: 12049.6451
Epoch [37/40], Step [800/1001], Loss: 4.4855, Perplexity: 88.7227, Time: 12081.5854
Epoch [37/40], Step [900/1001], Loss: 4.4308, Perplexity: 83.9977, Time: 12113.1643
Epoch [37/40], Step [1000/1001], Loss: 4.4564, Perplexity: 86.1775, Time: 12144.7857
Epoch [38/40], Step [0/1001], Loss: 4.2936, Perplexity: 73.2293, Time: 12145.6494
Epoch [38/40], Step [100/1001], Loss: 3.5390, Perplexity: 34.4312, Time: 12177.2440
Epoch [38/40], Step [200/1001], Loss: 4.3327, Perplexity: 76.1527, Time: 12209.5465
Epoch [38/40], Step [300/1001], Loss: 4.7766, Perplexity: 118.7017, Time: 12241.8175
Epoch [38/40], Step [400/1001], Loss: 4.6830, Perplexity: 108.0967, Time: 12273.3002
Epoch [38/40], Step [500/1001], Loss: 4.3815, Perplexity: 79.9583, Time: 12304.8451
Epoch [38/40], Step [600/1001], Loss: 4.4425, Perplexity: 84.9854, Time: 12336.3750
Epoch [38/40], Step [700/1001], Loss: 3.6130, Perplexity: 37.0790, Time: 12368.1536
Epoch [38/40], Step [800/1001], Loss: 4.4592, Perplexity: 86.4193, Time: 12399.9762
Epoch [38/40], Step [900/1001], Loss: 4.5512, Perplexity: 94.7484, Time: 12431.7732
Epoch [38/40], Step [1000/1001], Loss: 4.1634, Perplexity: 64.2886, Time: 12463.7663
Epoch [39/40], Step [0/1001], Loss: 4.0678, Perplexity: 58.4273, Time: 12464.4871
Epoch [39/40], Step [100/1001], Loss: 4.0386, Perplexity: 56.7478, Time: 12496.3378
Epoch [39/40], Step [200/1001], Loss: 4.2320, Perplexity: 68.8536, Time: 12527.9106
Epoch [39/40], Step [300/1001], Loss: 4.6762, Perplexity: 107.3654, Time: 12559.9168
Epoch [39/40], Step [400/1001], Loss: 4.3107, Perplexity: 74.4898, Time: 12591.6595
Epoch [39/40], Step [500/1001], Loss: 4.4727, Perplexity: 87.5893, Time: 12626.7945
Epoch [39/40], Step [600/1001], Loss: 4.5678, Perplexity: 96.3322, Time: 12658.5127
Epoch [39/40], Step [700/1001], Loss: 4.5526, Perplexity: 94.8825, Time: 12690.1518
Epoch [39/40], Step [800/1001], Loss: 4.2156, Perplexity: 67.7366, Time: 12721.6251
Epoch [39/40], Step [900/1001], Loss: 4.2059, Perplexity: 67.0807, Time: 12753.2281
Namespace(batch_size=50, caption_path='./coco/annotations/sm_captions_train2014.json', crop_size=224, embed_size=128, hidden_size=128, image_dir='./data/resized2014', learning_rate=0.001, log_step=100, model_path='./models/ATT', num_epochs=50, num_layers=1, num_workers=2, save_step=10, vocab_path='./data/vocab.pkl')
loading annotations into memory...
0:00:00.084726
creating index...
index created!
----- DATA_LOADER -- loaded data ----
---- USING GPU ----
Epoch [0/50], Step [0/501], Loss: 9.2091, Perplexity: 9987.7441, Time: 0.8201
Epoch [0/50], Step [100/501], Loss: 4.1356, Perplexity: 62.5296, Time: 47.4977
Epoch [0/50], Step [200/501], Loss: 2.2188, Perplexity: 9.1963, Time: 95.8142
Epoch [0/50], Step [300/501], Loss: 4.0030, Perplexity: 54.7639, Time: 143.6577
Epoch [0/50], Step [400/501], Loss: 2.2451, Perplexity: 9.4413, Time: 191.8165
Epoch [0/50], Step [500/501], Loss: 4.6891, Perplexity: 108.7537, Time: 239.4502
Epoch [1/50], Step [0/501], Loss: 3.8836, Perplexity: 48.5997, Time: 240.4107
Epoch [1/50], Step [100/501], Loss: 4.0292, Perplexity: 56.2133, Time: 288.7568
Epoch [1/50], Step [200/501], Loss: 3.4949, Perplexity: 32.9464, Time: 336.0600
Epoch [1/50], Step [300/501], Loss: 3.8938, Perplexity: 49.0977, Time: 383.9830
Epoch [1/50], Step [400/501], Loss: 3.2833, Perplexity: 26.6633, Time: 432.3743
Epoch [1/50], Step [500/501], Loss: 4.5431, Perplexity: 93.9824, Time: 479.5281
Epoch [2/50], Step [0/501], Loss: 4.2396, Perplexity: 69.3767, Time: 480.4369
Epoch [2/50], Step [100/501], Loss: 4.4737, Perplexity: 87.6845, Time: 528.5403
Epoch [2/50], Step [200/501], Loss: 3.9004, Perplexity: 49.4235, Time: 575.9315
Epoch [2/50], Step [300/501], Loss: 4.1506, Perplexity: 63.4726, Time: 623.5411
Epoch [2/50], Step [400/501], Loss: 3.8011, Perplexity: 44.7491, Time: 671.0325
Epoch [2/50], Step [500/501], Loss: 4.2884, Perplexity: 72.8496, Time: 718.3129
Epoch [3/50], Step [0/501], Loss: 3.8828, Perplexity: 48.5608, Time: 719.0533
Epoch [3/50], Step [100/501], Loss: 4.5322, Perplexity: 92.9622, Time: 766.5087
Epoch [3/50], Step [200/501], Loss: 4.1130, Perplexity: 61.1284, Time: 814.2106
Epoch [3/50], Step [300/501], Loss: 3.6606, Perplexity: 38.8854, Time: 861.4881
Epoch [3/50], Step [400/501], Loss: 3.9737, Perplexity: 53.1817, Time: 909.3290
Epoch [3/50], Step [500/501], Loss: 4.1793, Perplexity: 65.3169, Time: 956.6370
Epoch [4/50], Step [0/501], Loss: 3.9685, Perplexity: 52.9038, Time: 957.5987
Epoch [4/50], Step [100/501], Loss: 3.0688, Perplexity: 21.5150, Time: 1005.8380
Epoch [4/50], Step [200/501], Loss: 3.9913, Perplexity: 54.1238, Time: 1053.0754
Epoch [4/50], Step [300/501], Loss: 2.2683, Perplexity: 9.6629, Time: 1101.3542
Epoch [4/50], Step [400/501], Loss: 3.7156, Perplexity: 41.0821, Time: 1149.3314
Epoch [4/50], Step [500/501], Loss: 4.7132, Perplexity: 111.4129, Time: 1196.5053
Epoch [5/50], Step [0/501], Loss: 3.9323, Perplexity: 51.0247, Time: 1197.3376
Epoch [5/50], Step [100/501], Loss: 3.5202, Perplexity: 33.7915, Time: 1245.1025
Epoch [5/50], Step [200/501], Loss: 3.9309, Perplexity: 50.9542, Time: 1293.8341
Epoch [5/50], Step [300/501], Loss: 3.8861, Perplexity: 48.7226, Time: 1341.6174
Epoch [5/50], Step [400/501], Loss: 4.3346, Perplexity: 76.2948, Time: 1389.9831
Epoch [5/50], Step [500/501], Loss: 5.1673, Perplexity: 175.4385, Time: 1437.1964
Epoch [6/50], Step [0/501], Loss: 3.8542, Perplexity: 47.1918, Time: 1438.0655
Epoch [6/50], Step [100/501], Loss: 3.8291, Perplexity: 46.0222, Time: 1485.6391
Epoch [6/50], Step [200/501], Loss: 4.1878, Perplexity: 65.8771, Time: 1533.4437
Epoch [6/50], Step [300/501], Loss: 4.1878, Perplexity: 65.8769, Time: 1581.3960
Epoch [6/50], Step [400/501], Loss: 4.3826, Perplexity: 80.0451, Time: 1629.6052
Epoch [6/50], Step [500/501], Loss: 4.2959, Perplexity: 73.3999, Time: 1677.0607
Epoch [7/50], Step [0/501], Loss: 3.6744, Perplexity: 39.4243, Time: 1678.0180
Epoch [7/50], Step [100/501], Loss: 3.5133, Perplexity: 33.5576, Time: 1725.6777
Epoch [7/50], Step [200/501], Loss: 3.8947, Perplexity: 49.1400, Time: 1773.9681
Epoch [7/50], Step [300/501], Loss: 3.9275, Perplexity: 50.7821, Time: 1821.9727
Epoch [7/50], Step [400/501], Loss: 3.1040, Perplexity: 22.2861, Time: 1870.7123
Epoch [7/50], Step [500/501], Loss: 4.8720, Perplexity: 130.5842, Time: 1918.3047
Epoch [8/50], Step [0/501], Loss: 3.7915, Perplexity: 44.3216, Time: 1919.2506
Epoch [8/50], Step [100/501], Loss: 4.2455, Perplexity: 69.7935, Time: 1967.6260
Epoch [8/50], Step [200/501], Loss: 3.8834, Perplexity: 48.5902, Time: 2015.9510
Epoch [8/50], Step [300/501], Loss: 3.5461, Perplexity: 34.6779, Time: 2063.6335
Epoch [8/50], Step [400/501], Loss: 2.1101, Perplexity: 8.2492, Time: 2111.2892
Epoch [8/50], Step [500/501], Loss: 4.4196, Perplexity: 83.0610, Time: 2158.3475
Epoch [9/50], Step [0/501], Loss: 4.3030, Perplexity: 73.9218, Time: 2159.1126
Epoch [9/50], Step [100/501], Loss: 3.2257, Perplexity: 25.1703, Time: 2207.3390
Epoch [9/50], Step [200/501], Loss: 4.2377, Perplexity: 69.2469, Time: 2254.9527
Epoch [9/50], Step [300/501], Loss: 3.9128, Perplexity: 50.0393, Time: 2303.2400
Epoch [9/50], Step [400/501], Loss: 3.9689, Perplexity: 52.9237, Time: 2350.7823
Epoch [9/50], Step [500/501], Loss: 4.0446, Perplexity: 57.0872, Time: 2398.0759
Epoch [10/50], Step [0/501], Loss: 4.2179, Perplexity: 67.8919, Time: 2398.9695
Epoch [10/50], Step [100/501], Loss: 3.7310, Perplexity: 41.7215, Time: 2446.8143
Epoch [10/50], Step [200/501], Loss: 3.7064, Perplexity: 40.7055, Time: 2494.8634
Epoch [10/50], Step [300/501], Loss: 3.8997, Perplexity: 49.3874, Time: 2542.2606
Epoch [10/50], Step [400/501], Loss: 4.0685, Perplexity: 58.4718, Time: 2589.9844
Epoch [10/50], Step [500/501], Loss: 4.3683, Perplexity: 78.9061, Time: 2637.7687
Epoch [11/50], Step [0/501], Loss: 3.5177, Perplexity: 33.7056, Time: 2638.7721
Epoch [11/50], Step [100/501], Loss: 4.0753, Perplexity: 58.8661, Time: 2686.5367
Epoch [11/50], Step [200/501], Loss: 2.9710, Perplexity: 19.5106, Time: 2734.9032
Epoch [11/50], Step [300/501], Loss: 4.0314, Perplexity: 56.3423, Time: 2783.1261
Epoch [11/50], Step [400/501], Loss: 4.6417, Perplexity: 103.7164, Time: 2831.4003
Epoch [11/50], Step [500/501], Loss: 4.3958, Perplexity: 81.1095, Time: 2879.3128
Epoch [12/50], Step [0/501], Loss: 3.9102, Perplexity: 49.9095, Time: 2880.1850
Epoch [12/50], Step [100/501], Loss: 4.0743, Perplexity: 58.8116, Time: 2928.3114
Epoch [12/50], Step [200/501], Loss: 2.4817, Perplexity: 11.9619, Time: 2975.9990
Epoch [12/50], Step [300/501], Loss: 2.7264, Perplexity: 15.2785, Time: 3024.2657
Epoch [12/50], Step [400/501], Loss: 3.7188, Perplexity: 41.2164, Time: 3072.5040
Epoch [12/50], Step [500/501], Loss: 4.3942, Perplexity: 80.9836, Time: 3120.5186
Epoch [13/50], Step [0/501], Loss: 3.8292, Perplexity: 46.0267, Time: 3121.3688
Epoch [13/50], Step [100/501], Loss: 4.0251, Perplexity: 55.9867, Time: 3170.1138
Epoch [13/50], Step [200/501], Loss: 4.6591, Perplexity: 105.5363, Time: 3217.3010
Epoch [13/50], Step [300/501], Loss: 4.0261, Perplexity: 56.0422, Time: 3266.0123
Epoch [13/50], Step [400/501], Loss: 3.7913, Perplexity: 44.3128, Time: 3313.6022
Epoch [13/50], Step [500/501], Loss: 4.6604, Perplexity: 105.6734, Time: 3361.2707
Epoch [14/50], Step [0/501], Loss: 4.2295, Perplexity: 68.6829, Time: 3362.1581
Epoch [14/50], Step [100/501], Loss: 3.6115, Perplexity: 37.0225, Time: 3409.8268
Epoch [14/50], Step [200/501], Loss: 4.3535, Perplexity: 77.7468, Time: 3458.6840
Epoch [14/50], Step [300/501], Loss: 2.6815, Perplexity: 14.6067, Time: 3507.4220
Epoch [14/50], Step [400/501], Loss: 3.5824, Perplexity: 35.9592, Time: 3555.9156
Epoch [14/50], Step [500/501], Loss: 4.5273, Perplexity: 92.5051, Time: 3602.7760
Epoch [15/50], Step [0/501], Loss: 3.8916, Perplexity: 48.9872, Time: 3603.6597
Epoch [15/50], Step [100/501], Loss: 2.6009, Perplexity: 13.4765, Time: 3651.2231
Epoch [15/50], Step [200/501], Loss: 4.2855, Perplexity: 72.6354, Time: 3699.7921
Epoch [15/50], Step [300/501], Loss: 3.9665, Perplexity: 52.8011, Time: 3748.2895
Epoch [15/50], Step [400/501], Loss: 3.8520, Perplexity: 47.0866, Time: 3795.9125
Epoch [15/50], Step [500/501], Loss: 3.7796, Perplexity: 43.7984, Time: 3844.0927
Epoch [16/50], Step [0/501], Loss: 3.8448, Perplexity: 46.7508, Time: 3844.9474
Epoch [16/50], Step [100/501], Loss: 3.7146, Perplexity: 41.0441, Time: 3893.0181
Epoch [16/50], Step [200/501], Loss: 3.4713, Perplexity: 32.1786, Time: 3940.7159
Epoch [16/50], Step [300/501], Loss: 3.5547, Perplexity: 34.9760, Time: 3988.7451
Epoch [16/50], Step [400/501], Loss: 3.7891, Perplexity: 44.2185, Time: 4036.2823
Epoch [16/50], Step [500/501], Loss: 5.0528, Perplexity: 156.4646, Time: 4084.1329
Epoch [17/50], Step [0/501], Loss: 4.1037, Perplexity: 60.5625, Time: 4084.9359
Epoch [17/50], Step [100/501], Loss: 4.0954, Perplexity: 60.0608, Time: 4132.8252
Epoch [17/50], Step [200/501], Loss: 3.7304, Perplexity: 41.6964, Time: 4180.7935
Epoch [17/50], Step [300/501], Loss: 3.5812, Perplexity: 35.9175, Time: 4229.3357
Epoch [17/50], Step [400/501], Loss: 3.9302, Perplexity: 50.9149, Time: 4278.2216
Epoch [17/50], Step [500/501], Loss: 3.8594, Perplexity: 47.4345, Time: 4326.3665
Epoch [18/50], Step [0/501], Loss: 4.2328, Perplexity: 68.9086, Time: 4327.2092
Epoch [18/50], Step [100/501], Loss: 3.7402, Perplexity: 42.1057, Time: 4375.4128
Epoch [18/50], Step [200/501], Loss: 4.0717, Perplexity: 58.6587, Time: 4423.9689
Epoch [18/50], Step [300/501], Loss: 4.1410, Perplexity: 62.8674, Time: 4472.5723
Epoch [18/50], Step [400/501], Loss: 3.7217, Perplexity: 41.3339, Time: 4520.2974
Epoch [18/50], Step [500/501], Loss: 4.2416, Perplexity: 69.5176, Time: 4568.5718
Epoch [19/50], Step [0/501], Loss: 3.0303, Perplexity: 20.7024, Time: 4569.5569
Epoch [19/50], Step [100/501], Loss: 4.3174, Perplexity: 74.9963, Time: 4617.8402
Epoch [19/50], Step [200/501], Loss: 3.8105, Perplexity: 45.1751, Time: 4665.8400
Epoch [19/50], Step [300/501], Loss: 2.2186, Perplexity: 9.1943, Time: 4714.2050
Epoch [19/50], Step [400/501], Loss: 4.2139, Perplexity: 67.6205, Time: 4761.8502
Epoch [19/50], Step [500/501], Loss: 4.4865, Perplexity: 88.8098, Time: 4808.9819
Epoch [20/50], Step [0/501], Loss: 3.6534, Perplexity: 38.6056, Time: 4809.8976
Epoch [20/50], Step [100/501], Loss: 3.3219, Perplexity: 27.7124, Time: 4858.4952
Epoch [20/50], Step [200/501], Loss: 3.8009, Perplexity: 44.7398, Time: 4905.9608
Epoch [20/50], Step [300/501], Loss: 3.7622, Perplexity: 43.0428, Time: 4953.7811
Epoch [20/50], Step [400/501], Loss: 3.9020, Perplexity: 49.5030, Time: 5001.4776
Epoch [20/50], Step [500/501], Loss: 4.3568, Perplexity: 78.0105, Time: 5048.5714
Epoch [21/50], Step [0/501], Loss: 3.4229, Perplexity: 30.6596, Time: 5049.6991
Epoch [21/50], Step [100/501], Loss: 3.3900, Perplexity: 29.6665, Time: 5097.4716
Epoch [21/50], Step [200/501], Loss: 4.4338, Perplexity: 84.2470, Time: 5145.2734
Epoch [21/50], Step [300/501], Loss: 3.6521, Perplexity: 38.5573, Time: 5192.7682
Epoch [21/50], Step [400/501], Loss: 3.6828, Perplexity: 39.7569, Time: 5240.2952
Epoch [21/50], Step [500/501], Loss: 4.6827, Perplexity: 108.0613, Time: 5288.0544
Epoch [22/50], Step [0/501], Loss: 3.9651, Perplexity: 52.7265, Time: 5288.9383
Epoch [22/50], Step [100/501], Loss: 3.3827, Perplexity: 29.4504, Time: 5336.5944
Epoch [22/50], Step [200/501], Loss: 3.6428, Perplexity: 38.1988, Time: 5384.3399
Epoch [22/50], Step [300/501], Loss: 3.6765, Perplexity: 39.5087, Time: 5432.6148
Epoch [22/50], Step [400/501], Loss: 3.8888, Perplexity: 48.8518, Time: 5480.7638
Epoch [22/50], Step [500/501], Loss: 4.1423, Perplexity: 62.9455, Time: 5529.2997
Epoch [23/50], Step [0/501], Loss: 4.1954, Perplexity: 66.3804, Time: 5530.2717
Epoch [23/50], Step [100/501], Loss: 3.8251, Perplexity: 45.8371, Time: 5578.2456
Epoch [23/50], Step [200/501], Loss: 3.3391, Perplexity: 28.1927, Time: 5626.0346
Epoch [23/50], Step [300/501], Loss: 4.0960, Perplexity: 60.0995, Time: 5674.0970
Epoch [23/50], Step [400/501], Loss: 4.2434, Perplexity: 69.6456, Time: 5721.7947
Epoch [23/50], Step [500/501], Loss: 4.4993, Perplexity: 89.9534, Time: 5769.0881
Epoch [24/50], Step [0/501], Loss: 4.0324, Perplexity: 56.3958, Time: 5769.9433
Epoch [24/50], Step [100/501], Loss: 3.9626, Perplexity: 52.5947, Time: 5817.8199
Epoch [24/50], Step [200/501], Loss: 3.6912, Perplexity: 40.0936, Time: 5865.4074
Epoch [24/50], Step [300/501], Loss: 3.3679, Perplexity: 29.0165, Time: 5913.4929
Epoch [24/50], Step [400/501], Loss: 4.4167, Perplexity: 82.8252, Time: 5962.0256
Epoch [24/50], Step [500/501], Loss: 4.4561, Perplexity: 86.1540, Time: 6010.3497
Epoch [25/50], Step [0/501], Loss: 4.1091, Perplexity: 60.8941, Time: 6011.3075
Epoch [25/50], Step [100/501], Loss: 2.5002, Perplexity: 12.1852, Time: 6059.7492
Epoch [25/50], Step [200/501], Loss: 3.5810, Perplexity: 35.9087, Time: 6107.8436
Epoch [25/50], Step [300/501], Loss: 3.6824, Perplexity: 39.7412, Time: 6156.2250
Epoch [25/50], Step [400/501], Loss: 3.8019, Perplexity: 44.7880, Time: 6204.7609
Epoch [25/50], Step [500/501], Loss: 4.4419, Perplexity: 84.9364, Time: 6253.4541
Epoch [26/50], Step [0/501], Loss: 3.8414, Perplexity: 46.5928, Time: 6254.3651
Epoch [26/50], Step [100/501], Loss: 3.3336, Perplexity: 28.0380, Time: 6302.9973
Epoch [26/50], Step [200/501], Loss: 4.0615, Perplexity: 58.0642, Time: 6351.7834
Epoch [26/50], Step [300/501], Loss: 3.2555, Perplexity: 25.9324, Time: 6399.9783
Epoch [26/50], Step [400/501], Loss: 3.8644, Perplexity: 47.6751, Time: 6448.2357
Epoch [26/50], Step [500/501], Loss: 4.8350, Perplexity: 125.8350, Time: 6496.5896
Epoch [27/50], Step [0/501], Loss: 4.2266, Perplexity: 68.4809, Time: 6497.5137
Epoch [27/50], Step [100/501], Loss: 3.1548, Perplexity: 23.4476, Time: 6546.1684
Epoch [27/50], Step [200/501], Loss: 3.0927, Perplexity: 22.0355, Time: 6594.5924
Epoch [27/50], Step [300/501], Loss: 4.0957, Perplexity: 60.0834, Time: 6643.0511
Epoch [27/50], Step [400/501], Loss: 3.5919, Perplexity: 36.3030, Time: 6691.3260
Epoch [27/50], Step [500/501], Loss: 4.1651, Perplexity: 64.3980, Time: 6739.7191
Epoch [28/50], Step [0/501], Loss: 3.3969, Perplexity: 29.8728, Time: 6740.8454
Epoch [28/50], Step [100/501], Loss: 4.1115, Perplexity: 61.0395, Time: 6788.7397
Epoch [28/50], Step [200/501], Loss: 4.2382, Perplexity: 69.2829, Time: 6837.4976
Epoch [28/50], Step [300/501], Loss: 4.0418, Perplexity: 56.9275, Time: 6886.2217
Epoch [28/50], Step [400/501], Loss: 4.3232, Perplexity: 75.4289, Time: 6934.1554
Epoch [28/50], Step [500/501], Loss: 4.0695, Perplexity: 58.5266, Time: 6982.6487
Epoch [29/50], Step [0/501], Loss: 4.5766, Perplexity: 97.1840, Time: 6983.4846
Epoch [29/50], Step [100/501], Loss: 4.1200, Perplexity: 61.5615, Time: 7031.4293
Epoch [29/50], Step [200/501], Loss: 3.2636, Perplexity: 26.1440, Time: 7080.0579
Epoch [29/50], Step [300/501], Loss: 3.7850, Perplexity: 44.0374, Time: 7128.0862
Epoch [29/50], Step [400/501], Loss: 3.6827, Perplexity: 39.7531, Time: 7175.2998
Epoch [29/50], Step [500/501], Loss: 4.2925, Perplexity: 73.1518, Time: 7224.1363
Epoch [30/50], Step [0/501], Loss: 3.4282, Perplexity: 30.8211, Time: 7225.0916
Epoch [30/50], Step [100/501], Loss: 3.8714, Perplexity: 48.0108, Time: 7273.2451
Epoch [30/50], Step [200/501], Loss: 3.8669, Perplexity: 47.7963, Time: 7321.4162
Epoch [30/50], Step [300/501], Loss: 3.4220, Perplexity: 30.6311, Time: 7369.6236
Epoch [30/50], Step [400/501], Loss: 3.9593, Perplexity: 52.4219, Time: 7418.2069
Epoch [30/50], Step [500/501], Loss: 4.3248, Perplexity: 75.5473, Time: 7465.9453
Epoch [31/50], Step [0/501], Loss: 4.1115, Perplexity: 61.0369, Time: 7466.8099
Epoch [31/50], Step [100/501], Loss: 3.5327, Perplexity: 34.2177, Time: 7515.3407
Epoch [31/50], Step [200/501], Loss: 4.0508, Perplexity: 57.4441, Time: 7562.8412
Epoch [31/50], Step [300/501], Loss: 4.1988, Perplexity: 66.6094, Time: 7610.8436
Epoch [31/50], Step [400/501], Loss: 3.9609, Perplexity: 52.5028, Time: 7658.6747
Epoch [31/50], Step [500/501], Loss: 3.7090, Perplexity: 40.8143, Time: 7705.9552
Epoch [32/50], Step [0/501], Loss: 4.3098, Perplexity: 74.4263, Time: 7706.8188
Epoch [32/50], Step [100/501], Loss: 3.2812, Perplexity: 26.6069, Time: 7754.3495
Epoch [32/50], Step [200/501], Loss: 3.8296, Perplexity: 46.0428, Time: 7802.4343
Epoch [32/50], Step [300/501], Loss: 3.8440, Perplexity: 46.7118, Time: 7850.7942
Epoch [32/50], Step [400/501], Loss: 3.1685, Perplexity: 23.7718, Time: 7899.3581
Epoch [32/50], Step [500/501], Loss: 4.1548, Perplexity: 63.7364, Time: 7947.4686
Epoch [33/50], Step [0/501], Loss: 3.9973, Perplexity: 54.4528, Time: 7948.4568
Epoch [33/50], Step [100/501], Loss: 3.8649, Perplexity: 47.6970, Time: 7996.7430
Epoch [33/50], Step [200/501], Loss: 3.7935, Perplexity: 44.4121, Time: 8045.3732
Epoch [33/50], Step [300/501], Loss: 4.1371, Perplexity: 62.6239, Time: 8093.8998
Epoch [33/50], Step [400/501], Loss: 3.1544, Perplexity: 23.4386, Time: 8141.7752
Epoch [33/50], Step [500/501], Loss: 4.0886, Perplexity: 59.6568, Time: 8188.9267
Epoch [34/50], Step [0/501], Loss: 3.3591, Perplexity: 28.7645, Time: 8189.8410
Epoch [34/50], Step [100/501], Loss: 4.1385, Perplexity: 62.7063, Time: 8237.4095
Epoch [34/50], Step [200/501], Loss: 3.7790, Perplexity: 43.7726, Time: 8285.7119
Epoch [34/50], Step [300/501], Loss: 2.6612, Perplexity: 14.3135, Time: 8333.6800
Epoch [34/50], Step [400/501], Loss: 4.8228, Perplexity: 124.3086, Time: 8381.7681
Epoch [34/50], Step [500/501], Loss: 4.0785, Perplexity: 59.0588, Time: 8428.9878
Epoch [35/50], Step [0/501], Loss: 3.6409, Perplexity: 38.1261, Time: 8429.9190
Epoch [35/50], Step [100/501], Loss: 3.1323, Perplexity: 22.9263, Time: 8477.6490
Epoch [35/50], Step [200/501], Loss: 4.2774, Perplexity: 72.0543, Time: 8525.6436
Epoch [35/50], Step [300/501], Loss: 2.9852, Perplexity: 19.7906, Time: 8573.7823
Epoch [35/50], Step [400/501], Loss: 4.0527, Perplexity: 57.5529, Time: 8622.4530
Epoch [35/50], Step [500/501], Loss: 4.7968, Perplexity: 121.1260, Time: 8671.1619
Epoch [36/50], Step [0/501], Loss: 2.9497, Perplexity: 19.1011, Time: 8672.1454
Epoch [36/50], Step [100/501], Loss: 4.5625, Perplexity: 95.8186, Time: 8719.8337
Epoch [36/50], Step [200/501], Loss: 3.4762, Perplexity: 32.3372, Time: 8767.4986
Epoch [36/50], Step [300/501], Loss: 3.2986, Perplexity: 27.0745, Time: 8815.2181
Epoch [36/50], Step [400/501], Loss: 3.4088, Perplexity: 30.2289, Time: 8862.7838
Epoch [36/50], Step [500/501], Loss: 3.7663, Perplexity: 43.2199, Time: 8909.6944
Epoch [37/50], Step [0/501], Loss: 3.7294, Perplexity: 41.6560, Time: 8910.5885
Epoch [37/50], Step [100/501], Loss: 3.3479, Perplexity: 28.4442, Time: 8958.4132
Epoch [37/50], Step [200/501], Loss: 3.7948, Perplexity: 44.4675, Time: 9005.2309
Epoch [37/50], Step [300/501], Loss: 3.0785, Perplexity: 21.7247, Time: 9052.5287
Epoch [37/50], Step [400/501], Loss: 4.4140, Perplexity: 82.5959, Time: 9099.9219
Epoch [37/50], Step [500/501], Loss: 5.0986, Perplexity: 163.7891, Time: 9147.7612
Epoch [38/50], Step [0/501], Loss: 3.3167, Perplexity: 27.5683, Time: 9148.6036
Epoch [38/50], Step [100/501], Loss: 4.0286, Perplexity: 56.1838, Time: 9196.1188
Epoch [38/50], Step [200/501], Loss: 3.2361, Perplexity: 25.4343, Time: 9243.0811
Epoch [38/50], Step [300/501], Loss: 3.9191, Perplexity: 50.3537, Time: 9290.5998
Epoch [38/50], Step [400/501], Loss: 4.1855, Perplexity: 65.7265, Time: 9338.2273
Epoch [38/50], Step [500/501], Loss: 4.6011, Perplexity: 99.5970, Time: 9386.9006
Epoch [39/50], Step [0/501], Loss: 3.8013, Perplexity: 44.7594, Time: 9387.7923
Epoch [39/50], Step [100/501], Loss: 3.1357, Perplexity: 23.0045, Time: 9435.0538
Epoch [39/50], Step [200/501], Loss: 4.1623, Perplexity: 64.2218, Time: 9483.0022
Epoch [39/50], Step [300/501], Loss: 3.4755, Perplexity: 32.3139, Time: 9530.6880
Epoch [39/50], Step [400/501], Loss: 3.2755, Perplexity: 26.4560, Time: 9579.0217
Epoch [39/50], Step [500/501], Loss: 4.5733, Perplexity: 96.8659, Time: 9625.8320
Epoch [40/50], Step [0/501], Loss: 4.6910, Perplexity: 108.9651, Time: 9626.6532
Epoch [40/50], Step [100/501], Loss: 3.6574, Perplexity: 38.7611, Time: 9673.7643
Epoch [40/50], Step [200/501], Loss: 4.1019, Perplexity: 60.4544, Time: 9721.7310
Epoch [40/50], Step [300/501], Loss: 3.1931, Perplexity: 24.3629, Time: 9770.8674
Epoch [40/50], Step [400/501], Loss: 3.9572, Perplexity: 52.3089, Time: 9818.3950
Epoch [40/50], Step [500/501], Loss: 4.4723, Perplexity: 87.5573, Time: 9865.4490
Epoch [41/50], Step [0/501], Loss: 4.2054, Perplexity: 67.0463, Time: 9866.3008
Epoch [41/50], Step [100/501], Loss: 4.3200, Perplexity: 75.1871, Time: 9913.5263
Epoch [41/50], Step [200/501], Loss: 3.7605, Perplexity: 42.9698, Time: 9960.8342
Epoch [41/50], Step [300/501], Loss: 4.0662, Perplexity: 58.3367, Time: 10008.2221
Epoch [41/50], Step [400/501], Loss: 4.2212, Perplexity: 68.1147, Time: 10056.1959
Epoch [41/50], Step [500/501], Loss: 4.4419, Perplexity: 84.9396, Time: 10104.8002
Epoch [42/50], Step [0/501], Loss: 4.5120, Perplexity: 91.1004, Time: 10105.6992
Epoch [42/50], Step [100/501], Loss: 3.6966, Perplexity: 40.3098, Time: 10153.1338
Epoch [42/50], Step [200/501], Loss: 3.9798, Perplexity: 53.5053, Time: 10200.1395
Epoch [42/50], Step [300/501], Loss: 3.3640, Perplexity: 28.9031, Time: 10247.2232
Epoch [42/50], Step [400/501], Loss: 4.1379, Perplexity: 62.6688, Time: 10294.5321
Epoch [42/50], Step [500/501], Loss: 3.7129, Perplexity: 40.9724, Time: 10341.8400
Epoch [43/50], Step [0/501], Loss: 3.6371, Perplexity: 37.9814, Time: 10342.6544
Epoch [43/50], Step [100/501], Loss: 3.7438, Perplexity: 42.2582, Time: 10390.4958
Epoch [43/50], Step [200/501], Loss: 3.5744, Perplexity: 35.6747, Time: 10437.7773
Epoch [43/50], Step [300/501], Loss: 3.9757, Perplexity: 53.2866, Time: 10485.0617
Epoch [43/50], Step [400/501], Loss: 4.1956, Perplexity: 66.3945, Time: 10532.8422
Epoch [43/50], Step [500/501], Loss: 4.2254, Perplexity: 68.4025, Time: 10579.7140
Epoch [44/50], Step [0/501], Loss: 4.0394, Perplexity: 56.7923, Time: 10580.5321
Epoch [44/50], Step [100/501], Loss: 4.3038, Perplexity: 73.9769, Time: 10627.6801
Epoch [44/50], Step [200/501], Loss: 3.3927, Perplexity: 29.7472, Time: 10675.0541
Epoch [44/50], Step [300/501], Loss: 3.7852, Perplexity: 44.0456, Time: 10722.8369
Epoch [44/50], Step [400/501], Loss: 3.9578, Perplexity: 52.3427, Time: 10770.2414
Epoch [44/50], Step [500/501], Loss: 5.2681, Perplexity: 194.0412, Time: 10817.3483
Epoch [45/50], Step [0/501], Loss: 3.8287, Perplexity: 46.0011, Time: 10818.1143
Epoch [45/50], Step [100/501], Loss: 3.8110, Perplexity: 45.1973, Time: 10865.9505
Epoch [45/50], Step [200/501], Loss: 3.4569, Perplexity: 31.7175, Time: 10913.8518
Epoch [45/50], Step [300/501], Loss: 3.4969, Perplexity: 33.0124, Time: 10961.4556
Epoch [45/50], Step [400/501], Loss: 2.6022, Perplexity: 13.4931, Time: 11010.7000
Epoch [45/50], Step [500/501], Loss: 4.5083, Perplexity: 90.7663, Time: 11058.8036
Epoch [46/50], Step [0/501], Loss: 4.0734, Perplexity: 58.7570, Time: 11059.6527
Epoch [46/50], Step [100/501], Loss: 3.4996, Perplexity: 33.1006, Time: 11107.6388
Epoch [46/50], Step [200/501], Loss: 3.4558, Perplexity: 31.6823, Time: 11155.1363
Epoch [46/50], Step [300/501], Loss: 3.0475, Perplexity: 21.0636, Time: 11201.8720
Epoch [46/50], Step [400/501], Loss: 3.2089, Perplexity: 24.7517, Time: 11249.9804
Epoch [46/50], Step [500/501], Loss: 3.9962, Perplexity: 54.3912, Time: 11298.3384
Epoch [47/50], Step [0/501], Loss: 3.3180, Perplexity: 27.6059, Time: 11299.3451
Epoch [47/50], Step [100/501], Loss: 3.9912, Perplexity: 54.1188, Time: 11346.4476
Epoch [47/50], Step [200/501], Loss: 3.5028, Perplexity: 33.2082, Time: 11394.7315
Epoch [47/50], Step [300/501], Loss: 4.5835, Perplexity: 97.8584, Time: 11443.3895
Epoch [47/50], Step [400/501], Loss: 3.9150, Perplexity: 50.1512, Time: 11492.3030
Epoch [47/50], Step [500/501], Loss: 4.6014, Perplexity: 99.6249, Time: 11540.6726
Epoch [48/50], Step [0/501], Loss: 4.6805, Perplexity: 107.8242, Time: 11541.5560
Epoch [48/50], Step [100/501], Loss: 4.3063, Perplexity: 74.1659, Time: 11589.7164
Epoch [48/50], Step [200/501], Loss: 3.9141, Perplexity: 50.1055, Time: 11637.5088
Epoch [48/50], Step [300/501], Loss: 4.3148, Perplexity: 74.7989, Time: 11685.7748
Epoch [48/50], Step [400/501], Loss: 3.7656, Perplexity: 43.1880, Time: 11733.7311
Epoch [48/50], Step [500/501], Loss: 4.5897, Perplexity: 98.4687, Time: 11780.8644
Epoch [49/50], Step [0/501], Loss: 3.9799, Perplexity: 53.5123, Time: 11781.7809
Epoch [49/50], Step [100/501], Loss: 3.1937, Perplexity: 24.3792, Time: 11829.5445
Epoch [49/50], Step [200/501], Loss: 3.8655, Perplexity: 47.7276, Time: 11878.5068
Epoch [49/50], Step [300/501], Loss: 2.8807, Perplexity: 17.8275, Time: 11926.3199
Epoch [48/50], Step [400/501], Loss: 3.7656, Perplexity: 43.1880, Time: 11733.7311
Epoch [48/50], Step [500/501], Loss: 4.5897, Perplexity: 98.4687, Time: 11780.8644
Epoch [49/50], Step [0/501], Loss: 3.9799, Perplexity: 53.5123, Time: 11781.7809
Epoch [49/50], Step [100/501], Loss: 3.1937, Perplexity: 24.3792, Time: 11829.5445
Epoch [49/50], Step [200/501], Loss: 3.8655, Perplexity: 47.7276, Time: 11878.5068
Epoch [49/50], Step [300/501], Loss: 2.8807, Perplexity: 17.8275, Time: 11926.3199
Epoch [49/50], Step [400/501], Loss: 3.8413, Perplexity: 46.5840, Time: 11974.0486
train_att.py:109: UserWarning: invalid index of a 0-dim tensor. This will be an error in PyTorch 0.5. Use tensor.item() to convert a 0-dim tensor to a Python number
  print '%s - loss: %.4f - time: %.4f'%(i, loss.data[0], time.time()-t0);
Epoch [49/50], Step [500/501], Loss: 4.6074, Perplexity: 100.2281, Time: 12022.1577
saving final model
500 - loss: 4.6074 - time: 12022.1611
